---
- name: Gather credentials - PB1
  hosts: all
  gather_facts: false
# prerequisites = have a collections folder in your repo
# with requirements.yml in it with the following:
#---
#collections:
#- pge_util.papm_util
##
  tasks:
# 
# task needed for credentials in playbookone.yml
#
  - name: Include task list in play - import - task 1
    ansible.builtin.import_tasks:
      # make sure to have playbookone in your repo 
      file: playbookone.yml

- name: PB2
  hosts: all
  gather_facts: true
  vars: 
    S1:EMPTY
    S2:EMPTY
    S3:EMPTY
    S4:EMPTY

  tasks:
  # "WinHTTP Web Proxy Auto-Discovery Service"
  # name: "spooler","WinHttpAutoProxySvc"
  - name: loop through services
    debug: 
      msg: "{{ item.name }}"
  - name: check service
    ansible.windows.win_service_info:
      name: "{{ item.name }}"
    #register: "{{ item.result }}"
    loop:
      - { name: 'spooler', result : 'S1' }
      - { name: 'WinHttpAutoProxySvc"', result: 'S2' }
